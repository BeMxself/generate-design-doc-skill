# Java 基础架构模块 — 分析指导

## 分析模板

### 第一轮：结构扫描
- `pom.xml` → 子模块划分、依赖关系、打包方式
- 目录结构 → 包组织方式、分层架构
- `README.md` / `AGENTS.md` → 已有文档和项目约定
- 全局搜索 → 哪些模块依赖本模块（谁在“使用这些抽象”）

### 第二轮：核心代码扫描
- 公开接口（`interface`）和抽象类 → 模块的契约定义
- 抽象概念与核心模型 → 关键术语、状态机、生命周期、边界条件（先把“概念图”讲清楚）
- 核心数据模型 / 实体类 → 模块操作的数据结构
- 工厂类、Builder、Registry → 对象创建和管理方式
- 配置类（`@Configuration`, `@ConfigurationProperties`）→ 可配置项

### 第三轮：特征探测
- `META-INF/services/` → SPI 扩展点
- `META-INF/spring.factories` 或 `AutoConfiguration` → Spring Boot 集成
- `Plugin` / `Extension` / `Handler` 接口 → 插件机制
- Strategy / Template Method / Chain / Pipeline → 框架骨架与扩展策略（按包/命名/调用链识别）
- `ServiceLoader` / `@Order` / Priority / 排序器 → 扩展装配顺序与选择规则
- `@ConditionalOn*` / profile / feature flags → 扩展启用条件
- `synchronized` / `Lock` / `Atomic*` / `ThreadLocal` → 并发策略
- `@Transactional` / `TransactionTemplate` → 事务管理
- `@PostConstruct` / `InitializingBean` / `DisposableBean` → 生命周期
- 自定义异常类层次 → 异常体系

## 问题清单

### AI 自答（扫描代码确认）
1. 模块的核心职责是什么？解决什么问题？
2. 子模块如何划分？各自职责？
3. 公开 API 有哪些？核心接口 vs 辅助接口？
4. 核心数据模型是什么？实体间关系？
5. 抽象概念是什么？（术语表 + 概念关系 + 不变式/约束）
6. 是否有 SPI 扩展点？有几个？内置实现有哪些？
7. 扩展方式是什么？（实现哪个接口 → 如何注册/发现 → 如何排序/选择 → 如何配置启用 → 最小示例）
8. 并发策略是什么？哪些组件是线程安全的？
9. 是否有事务管理？边界在哪一层？
10. 生命周期管理怎么做的？初始化/销毁流程？
11. 异常体系结构？自定义异常层次？
12. Spring Boot 自动配置了什么？配置属性有哪些？
13. 关键操作的执行路径是什么？
14. 模块使用了哪些设计模式？这些模式解决了什么问题？对扩展/维护有什么影响？

### 用户决策点
- 文档目标读者：模块使用者 or 模块维护者？
- 哪些"可选"章节需要深入展开？
- 是否需要包含设计模式分析？
- 是否需要包含性能相关说明？

## 章节推荐池

### 核心章节（几乎总是需要）
| 章节 | 内容 |
|------|------|
| 概述 | 核心职责、特性列表（3-5 项） |
| 模块结构 | 子模块表格（模块名 / 功能描述） |
| 抽象概念与核心模型 | 术语表、概念关系、生命周期与关键不变式 |
| 核心 API | 接口定义 + 方法签名，按职责分组 |

### 条件章节（探测到才推荐）
| 章节 | 触发条件 |
|------|---------|
| SPI 扩展点 | 发现 `META-INF/services/` 或 SPI 接口 |
| 插件/扩展系统 | 发现 Plugin/Extension 接口 |
| 扩展方式（指南） | 发现 1+ 个扩展点（SPI/Plugin/Strategy/Handler 等） |
| 线程安全与并发 | 发现并发原语或线程安全注解 |
| 事务管理 | 发现 `@Transactional` 或事务模板 |
| 异常体系 | 发现自定义异常类层次（3+ 个异常类） |
| 生命周期管理 | 发现初始化/销毁钩子 |
| Spring Boot 集成 | 发现自动配置类或配置属性 |

### 可选章节（用户选择是否展开）
| 章节 | 适用场景 |
|------|---------|
| 关键流程详解 | 核心操作路径复杂时 |
| 设计模式与扩展策略 | 模式是框架骨架的一部分，且影响扩展/装配时 |
| 性能考量 | 有性能敏感路径时 |
| 架构图 | 分层或组件关系复杂时 |
